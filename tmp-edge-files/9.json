{"name":"utils/automation.ts","content":"\r\nimport { AccountConfig, AutoResponse } from '../config/types.ts'\r\n\r\n/**\r\n * Verifica si el mensaje coincide con alguna regla de autorespuesta\r\n */\r\nexport function checkAutoResponses(messageText: string, config: AccountConfig): AutoResponse | null {\r\n    if (!config.autoResponses || config.autoResponses.length === 0) return null\r\n\r\n    const lowerMessage = messageText.toLowerCase()\r\n\r\n    // Sort by specific criteria if needed (e.g. exact match first)\r\n    // For now, iterate in order\r\n    for (const rule of config.autoResponses) {\r\n        if (!rule.isActive) continue\r\n\r\n        const trigger = (rule.triggerText || '').toLowerCase()\r\n        const matchType = rule.matchType || 'contains'\r\n\r\n        let isMatch = false\r\n\r\n        if (matchType === 'exact') {\r\n            isMatch = lowerMessage === trigger\r\n        } else {\r\n            // contains\r\n            isMatch = lowerMessage.includes(trigger)\r\n        }\r\n\r\n        if (isMatch) {\r\n            console.log(`âœ… [AUTOMATION] Auto-response triggered: ${rule.id} (${trigger})`)\r\n            return rule\r\n        }\r\n    }\r\n\r\n    return null\r\n}\r\n"}